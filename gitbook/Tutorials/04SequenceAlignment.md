# Sequence Alignment

### 打分矩阵
对于核苷酸比对的打分矩阵一般较简单，例如BLAST程序用于核苷酸序列比对的打分矩阵，如果比对的两个核苷酸相同，则得分+5，反之得分为-4。也可以对嘌呤与嘌呤间或嘧啶与嘧啶间替换设置很小的罚分(-1)，而对嘌呤(A或G)和嘧啶(C或T)间替换则进行较高的罚分(-5)。

### 空位罚分

### 局部比对
![全局比对与局部比对算法](https://raw.githubusercontent.com/adong77/bigbook/master/imageBed/book/fig4-6.png)

图 4-6全局比对与局部比对算法

### 构建PAM矩阵
基于进化的点突变模型，如果两种氨基酸替换频繁，说明自然界接受这种替换，那么这对氨基酸替换得分就高。PAM矩阵一般会带一个正整数后缀，比如PAM1。这个后缀表示PAM1矩阵自乘次数，如PAM50矩阵为PAM1自乘50次（50次方）。一个PAM1就是一个进化的变异单位, 即1%的氨基酸改变，但这并不意味自乘100次（PAM100），每个氨基酸都发生变化，因为其中一些位置可能会经过多次突变，甚至可能会变回到原来的氨基酸。这种矩阵的缺点是一旦PAM1的矩阵有误差，那么自乘250次后得到的PAM250矩阵的误差就会变得很大。

PAM矩阵的构造步骤：
1. 构建序列相似（大于85％）的比对
2. 计算氨基酸 j 的相对突变率mj（j被其它氨基酸替换的次数）
3. 针对每个氨基酸对 i 和 j , 计算 j 被 i 替换次数
4. 替换次数除以相对突变率（mj）
5. 利用每个氨基酸出现的频度对j 进行标准化
6. 取常用对数，得到PAM-1(i, j)
7. 将PAM-1自乘N次，可以得到PAM-N。

