贝叶斯概率与病毒检测

很多疾病的检测结果通常以阴性和阳性作为区分，艾滋病也不例外。目前，HIV(艾滋病病毒)检测方式是做血清抗体检测。数据的统计结果显示，真正得了艾滋病的患者在接受检测后结果呈现阳性的概率为99.8%，而健康人群检测结果为阴性的概率为99%。总体来说，检测结果还是很可靠的，得病的人基本会被检测出来，没有得病的人也能被准确也甄选出来。
老王是A国居民，A国的艾滋病感染率为0.0666%，A国总共有100万人。某天老王参加完聚会后感觉身体不是很舒服，于是去医院检查，检测结果是HIV阳性，老王非常害怕。那么老王实际得艾滋病的概率是多大呢？
是不是检测出了阳性就几乎可以肯定是艾滋病患者了呢？我们将使用贝叶斯的计算方法计算老王的得病概率。
根据故事背景，要求的是老王在检测为阳性的情况下患病的概率，即P(患病|阳性)，已知条件如下：
1.艾滋病患者在接受检测后的结果呈阳性的概率为99.%。
2.健康人群检测结果为阴性的概率为99%。
3.A国的艾滋病感染率为0.0666%。
4.A国总人口为100万人。
各类人群的人数总结如表所示：
|结果|患者|健康者|总计|
|----|----|----|----|
|阳性| 655 | 9993 | 10658 |
|阴性| 1 | 989341 | 989342 |

我们依据两个事件工作：
A: 患者得这种病
B: 检验结果呈阳性

其检验结果的准确性为:
P(A)=0.001 --1‰的人得这种病
P(B|A)=0.99 --真正得这种病的人检验结果呈阳性的概率为99%
P(B|A拔)=0.02 --没得这种病的人检验结果呈假阳性的概率为2%
则P(A|B)是多少? 即检验结果呈阳性并传染上该病的概率是多少?

根据贝叶斯定理，在血液检测阳性的的人群中，确定感染HIV的概率：
P(患病|阳性) = P(阳性|患病) X P(患病) / P(阳性|患病) X P(患病) + P(阳性|未患病) X P(未患病) 

即P(患病|阳性) = 665/10658 = 6.24%
在老王检测结果呈阳性的情况下，老王得艾滋病的概率仅为6.24%。
为什么检测阳性而患病概率这么低？这是因为虽然老王的检测结果呈阳性，但是假阳性的人数很多，因此即使老王的检测结果为阳性，也存在很大的概率并未得病。这也是艾滋病筛查需要检测多次的原因，通过多轮检测，层层筛选后，概率自然就会提高。

